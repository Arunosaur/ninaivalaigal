plugins {
    id 'java'
    id 'org.jetbrains.intellij' version '1.17.2'
}

group 'com.mem0'
version '0.1.0'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.apache.httpcomponents:httpclient:4.5.14'
    implementation 'org.json:json:20230618'
}

// See https://github.com/JetBrains/gradle-intellij-plugin/
intellij {
    version = '2022.1'
    type = 'IC' // IntelliJ IDEA Community Edition
    plugins = ['com.intellij.java']
}

patchPluginXml {
    changeNotes = """
      Initial release of mem0 JetBrains plugin:
      <ul>
        <li>Context-aware memory capture</li>
        <li>Integration with mem0 server</li>
        <li>Remember/recall functionality</li>
        <li>Multi-project context isolation</li>
      </ul>
      """
}

signPlugin {
    certificateChain = System.getenv("CERTIFICATE_CHAIN")
    privateKey = System.getenv("PRIVATE_KEY")
    password = System.getenv("PRIVATE_KEY_PASSWORD")
}

publishPlugin {
    token = System.getenv("PUBLISH_TOKEN")
}

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}
